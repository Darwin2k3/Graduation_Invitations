<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Graduation Invitation</title>
<style>
body {
  background: radial-gradient(circle at center, #011619, #000);
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  margin: 0;
  overflow: hidden;
  user-select: none;
}

/* Giữ tỉ lệ và tự co giãn trên mọi thiết bị */
.container {
  perspective: 2000px;
  width: 95vw;
  max-width: 900px;
  aspect-ratio: 9 / 5; /* Giữ đúng tỉ lệ ngang của thiệp */
}

.card {
  width: 100%;
  height: 100%;
  position: relative;
  transform-style: preserve-3d;
  transition: transform 0.2s linear;
  cursor: grab;
  border-radius: 10px;
  box-shadow: 0 15px 40px rgba(0,0,0,0.6);
}

.side {
  position: absolute;
  width: 100%;
  height: 100%;
  border-radius: 10px;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  overflow: hidden;
}

/* Giữ nguyên hình ảnh, không méo */
.front img, .back img {
  width: 100%;
  height: 100%;
  object-fit: contain; /* Hiển thị toàn bộ ảnh, không cắt */
  background-color: black; /* Đệm nền nếu ảnh không full */
  display: block;
}

/* mặt trước */
.front {
  transform: rotateY(0deg);
}

/* mặt sau — xoay 180 độ và lật lại để đúng chiều */
.back {
  transform: rotateY(180deg);
}

audio {
  display: none;
}

/* Tinh chỉnh cho điện thoại nhỏ */
@media (max-width: 600px) {
  .container {
    width: 100vw;
    aspect-ratio: 9 / 5;
  }
}
</style>
</head>
<body>
  <div class="container">
    <div id="card" class="card">
      <div class="side front"><img src="front.jpg" alt="Front"></div>
      <div class="side back"><img src="back.jpg" alt="Back"></div>
    </div>
  </div>

  <audio id="music" loop>
    <source src="music.mp3" type="audio/mpeg">
  </audio>

<script>
const card = document.getElementById('card');
const music = document.getElementById('music');
let isDragging = false;
let currentRotation = 0;
let startX = 0;
let velocity = 0;
let animationFrame;

function playMusic() {
  if (music.paused) music.play().catch(()=>{});
}

function startDrag(x) {
  isDragging = true;
  startX = x;
  card.style.cursor = 'grabbing';
  playMusic();
  cancelAnimationFrame(animationFrame);
}

function moveDrag(x) {
  if (!isDragging) return;
  const dx = x - startX;
  currentRotation += dx * 0.5;
  velocity = dx * 0.5;
  card.style.transform = `rotateY(${currentRotation}deg)`;
  startX = x;
}

function endDrag() {
  if (!isDragging) return;
  isDragging = false;
  card.style.cursor = 'grab';
  function inertia() {
    currentRotation += velocity;
    velocity *= 0.95;
    card.style.transform = `rotateY(${currentRotation}deg)`;
    if (Math.abs(velocity) > 0.2) {
      animationFrame = requestAnimationFrame(inertia);
    }
  }
  animationFrame = requestAnimationFrame(inertia);
}

// Mouse
card.addEventListener('mousedown', e => startDrag(e.clientX));
document.addEventListener('mousemove', e => moveDrag(e.clientX));
document.addEventListener('mouseup', endDrag);

// Touch
card.addEventListener('touchstart', e => startDrag(e.touches[0].clientX), {passive:true});
card.addEventListener('touchmove', e => moveDrag(e.touches[0].clientX), {passive:true});
card.addEventListener('touchend', endDrag);
</script>
</body>
</html>
